<?xml version="1.0" encoding="UTF-8" ?>
<Module>
  <ModulePrefs title="Recent Results for Custom City" title_url=""
		description="Recent results (last 10) for custom city" author="Indian Bridge"
		author_email="indianbridge+calendargadget@gmail.com" screenshot="" thumbnail=""
		height="400" scrolling="true">
    <Require feature="setprefs" />
  </ModulePrefs>
  <Content type="html">
    <![CDATA[
		<script type="text/javascript" src="https://www.google.com/jsapi"></script>
		<script type="text/javascript" src="https://bfi-scripts.googlecode.com/svn/trunk/querywrapper.js"></script>
		<script type="text/javascript">
		google.load('visualization', '1', {'packages' : ['orgchart']});
		google.setOnLoadCallback(function() { sendAndDraw('') });

		var dataSourceUrl = 'https://spreadsheets.google.com/tq?key=rCaVQNfFDMhOM6ENNYeYZ9Q&pub=1';
		var query;

		function sendAndDraw(queryString) {
		  var container = document.getElementById('orgchart');
		  var orgChart = new google.visualization.OrgChart(container);
		  query && query.abort();
		  query = new google.visualization.Query(dataSourceUrl + queryString);
		  var queryWrapper = new QueryWrapper(query, orgChart, {'size': 'large'}, container);
		  queryWrapper.sendAndDraw();
		}
		</script>
		<h1>Query Wrapper Example</h1>
		<form action="">
		  <span> This example uses the following spreadsheet: <br />
			<a href="https://spreadsheets.google.com/pub?key=rCaVQNfFDMhOM6ENNYeYZ9Q">
			  https://spreadsheets.google.com/pub?key=rCaVQNfFDMhOM6ENNYeYZ9Q
			</a></span>
		  <br /><br />
		  <select onChange="sendAndDraw(this.value)">
			<option value="">No query string</option>
			<option value="&tq=limit 3">query=limit 3</option>
			<option value="&tq=select G,H">(Error) query=select G,H</option>
		  </select>
		</form>
		<br />
		<div id="orgchart"></div>		
		]]>
  </Content>
</Module>